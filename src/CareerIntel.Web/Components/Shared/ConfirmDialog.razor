@if (_visible)
{
    <div class="dialog-overlay" @onclick="Cancel" role="presentation">
        <div class="dialog" role="alertdialog" aria-modal="true" aria-labelledby="confirm-title" aria-describedby="confirm-desc" @onclick:stopPropagation="true">
            <h3 id="confirm-title" class="card-title">@Title</h3>
            <p id="confirm-desc" class="text-muted" style="margin: 1rem 0;">@Message</p>
            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button class="btn" @onclick="Cancel">Cancel</button>
                <button class="btn btn-danger" @onclick="Confirm">@ConfirmText</button>
            </div>
        </div>
    </div>
}

@code {
    private bool _visible;
    private TaskCompletionSource<bool>? _tcs;

    [Parameter] public string Title { get; set; } = "Confirm";
    [Parameter] public string Message { get; set; } = "Are you sure?";
    [Parameter] public string ConfirmText { get; set; } = "Delete";

    public Task<bool> ShowAsync(string? message = null, string? title = null)
    {
        if (message is not null) Message = message;
        if (title is not null) Title = title;
        _tcs = new TaskCompletionSource<bool>();
        _visible = true;
        StateHasChanged();
        return _tcs.Task;
    }

    private void Confirm()
    {
        _visible = false;
        _tcs?.TrySetResult(true);
        StateHasChanged();
    }

    private void Cancel()
    {
        _visible = false;
        _tcs?.TrySetResult(false);
        StateHasChanged();
    }
}
